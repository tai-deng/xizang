$(function () {
  /* 工程管理饼状图（左） */
  let mychart_pie_one = echarts.init(document.getElementById("mychart_pie_one"));
  option_pie_one = {
    backgroundColor: "#03155A",
    // title: {
    //   text: "84%",
    //   subtext: '完成部门占比',
    //   x: 'center',
    //   y: 'center',
    //   textStyle: {
    //     color: "#fff",
    //     fontSize: 30,
    //     fontWeight: 'normal'
    //   },
    //   subtextStyle: {
    //     color: "rgba(255,255,255,.45)",
    //     fontSize: 14,
    //     fontWeight: 'normal'
    //   }
    // },
    tooltip: {
      trigger: 'item',
      formatter: "{a} <br/>{b} : {c} ({d}%)"
    },
    legend: {
      x: 'center',
      y: 'bottom',
      data: ['rose3', 'rose5', 'rose6', 'rose7', 'rose8']
    },
    calculable: true,
    series: [{
        name: '工程项目',
        type: 'pie',
        radius: [60, 80],
        center: ['50%', '50%'],
        labelLine: {
          show: false
        },
        data: [{
            value: 34,
            itemStyle: {
              color: new echarts.graphic.LinearGradient(0, 1, 0, 0, [{
                offset: 0,
                color: '#f6e3a1'
              }, {
                offset: 1,
                color: '#ff4236'
              }])
            },
            label: {
              color: "rgba(255,255,255,.45)",
              fontSize: 14,
              rich: {
                a: {
                  color: "#fff",
                  fontSize: 20,
                  lineHeight: 30
                },
              }
            }
          },
          {
            value: 52,
            itemStyle: {
              color: "transparent"
            }
          }
        ]
      },
      {
        name: '工程项目',
        type: 'pie',
        radius: [60, 80],
        center: ['50%', '50%'],
        labelLine: {
          show: false
        },
        data: [{
            value: 34,
            itemStyle: {
              color: "transparent"
            }
          },
          {
            value: 52,
            itemStyle: {
              color: new echarts.graphic.LinearGradient(0, 1, 0, 0, [{
                offset: 0,
                color: '#348fe6'
              }, {
                offset: 1,
                color: '#625bef'
              }])
            },
            label: {
              color: "rgba(255,255,255,.45)",
              fontSize: 14,
              rich: {
                a: {
                  color: "#fff",
                  fontSize: 20,
                  lineHeight: 30
                },
              }
            }
          }
        ]
      }
    ]
  };
  mychart_pie_one.setOption(option_pie_one);
  /* 工程管理饼状图（右） */
  let mychart_pie_two = echarts.init(document.getElementById("mychart_pie_two"));
  option_pie_two = {
    backgroundColor: "#03155A",
    // title: {
    //   text: "84%",
    //   subtext: '完成部门占比',
    //   x: 'center',
    //   y: 'center',
    //   textStyle: {
    //     color: "#fff",
    //     fontSize: 30,
    //     fontWeight: 'normal'
    //   },
    //   subtextStyle: {
    //     color: "rgba(255,255,255,.45)",
    //     fontSize: 14,
    //     fontWeight: 'normal'
    //   }
    // },
    tooltip: {
      trigger: 'item',
      formatter: "{a} <br/>{b} : {c} ({d}%)"
    },
    legend: {
      x: 'center',
      y: 'bottom',
      data: ['rose3', 'rose5', 'rose6', 'rose7', 'rose8']
    },
    calculable: true,
    series: [{
        name: '工程项目',
        type: 'pie',
        radius: [60, 80],
        center: ['50%', '50%'],
        labelLine: {
          show: false
        },
        data: [{
            value: 34,
            itemStyle: {
              color: new echarts.graphic.LinearGradient(0, 1, 0, 0, [{
                offset: 0,
                color: '#f6e3a1'
              }, {
                offset: 1,
                color: '#ff4236'
              }])
            },
            label: {
              color: "rgba(255,255,255,.45)",
              fontSize: 14,
              rich: {
                a: {
                  color: "#fff",
                  fontSize: 20,
                  lineHeight: 30
                },
              }
            }
          },
          {
            value: 52,
            itemStyle: {
              color: "transparent"
            }
          }
        ]
      },
      {
        name: '工程项目',
        type: 'pie',
        radius: [60, 80],
        center: ['50%', '50%'],
        labelLine: {
          show: false
        },
        data: [{
            value: 34,
            itemStyle: {
              color: "transparent"
            }
          },
          {
            value: 52,
            itemStyle: {
              color: new echarts.graphic.LinearGradient(0, 1, 0, 0, [{
                offset: 0,
                color: '#348fe6'
              }, {
                offset: 1,
                color: '#625bef'
              }])
            },
            label: {
              color: "rgba(255,255,255,.45)",
              fontSize: 14,
              rich: {
                a: {
                  color: "#fff",
                  fontSize: 20,
                  lineHeight: 30
                },
              }
            }
          }
        ]
      }
    ]
  };
  mychart_pie_two.setOption(option_pie_two);



  /* 投资管理（左） */
  let mychart_pie_three = echarts.init(document.getElementById("mychart_pie_three"));
  option_pie_three = {
    backgroundColor: "#03155A",
    // title: {
    //   text: "84%",
    //   subtext: '完成部门占比',
    //   x: 'center',
    //   y: 'center',
    //   textStyle: {
    //     color: "#fff",
    //     fontSize: 30,
    //     fontWeight: 'normal'
    //   },
    //   subtextStyle: {
    //     color: "rgba(255,255,255,.45)",
    //     fontSize: 14,
    //     fontWeight: 'normal'
    //   }
    // },
    tooltip: {
      trigger: 'item',
      formatter: "{a} <br/>{b} : {c} ({d}%)"
    },
    legend: {
      x: 'center',
      y: 'bottom',
      data: ['rose3', 'rose5', 'rose6', 'rose7', 'rose8']
    },
    calculable: true,
    series: [{
        name: '项目投资',
        type: 'pie',
        radius: [60, 80],
        center: ['50%', '50%'],
        labelLine: {
          show: false
        },
        data: [{
            value: 34,
            itemStyle: {
              color: new echarts.graphic.LinearGradient(0, 1, 0, 0, [{
                offset: 0,
                color: '#f6e3a1'
              }, {
                offset: 1,
                color: '#ff4236'
              }])
            },
            label: {
              color: "rgba(255,255,255,.45)",
              fontSize: 14,
              rich: {
                a: {
                  color: "#fff",
                  fontSize: 20,
                  lineHeight: 30
                },
              }
            }
          },
          {
            value: 52,
            itemStyle: {
              color: "transparent"
            }
          }
        ]
      },
      {
        name: '项目投资',
        type: 'pie',
        radius: [60, 80],
        center: ['50%', '50%'],
        labelLine: {
          show: false
        },
        data: [{
            value: 34,
            itemStyle: {
              color: "transparent"
            }
          },
          {
            value: 52,
            itemStyle: {
              color: new echarts.graphic.LinearGradient(0, 1, 0, 0, [{
                offset: 0,
                color: '#348fe6'
              }, {
                offset: 1,
                color: '#625bef'
              }])
            },
            label: {
              color: "rgba(255,255,255,.45)",
              fontSize: 14,
              rich: {
                a: {
                  color: "#fff",
                  fontSize: 20,
                  lineHeight: 30
                },
              }
            }
          }
        ]
      }
    ]
  };
  mychart_pie_three.setOption(option_pie_three);

  /* 投资管理（右） */
  let mychart_pie_four = echarts.init(document.getElementById("mychart_pie_four"));
  option_pie_four = {
    backgroundColor: "#03155A",
    // title: {
    //   text: "84%",
    //   subtext: '完成部门占比',
    //   x: 'center',
    //   y: 'center',
    //   textStyle: {
    //     color: "#fff",
    //     fontSize: 30,
    //     fontWeight: 'normal'
    //   },
    //   subtextStyle: {
    //     color: "rgba(255,255,255,.45)",
    //     fontSize: 14,
    //     fontWeight: 'normal'
    //   }
    // },
    tooltip: {
      trigger: 'item',
      formatter: "{a} <br/>{b} : {c} ({d}%)"
    },
    legend: {
      x: 'center',
      y: 'bottom',
      data: ['rose3', 'rose5', 'rose6', 'rose7', 'rose8']
    },
    calculable: true,
    series: [{
        name: '项目投资',
        type: 'pie',
        radius: [60, 80],
        center: ['50%', '50%'],
        labelLine: {
          show: false
        },
        data: [{
            value: 34,
            itemStyle: {
              color: new echarts.graphic.LinearGradient(0, 1, 0, 0, [{
                offset: 0,
                color: '#f6e3a1'
              }, {
                offset: 1,
                color: '#ff4236'
              }])
            },
            label: {
              color: "rgba(255,255,255,.45)",
              fontSize: 14,
              rich: {
                a: {
                  color: "#fff",
                  fontSize: 20,
                  lineHeight: 30
                },
              }
            }
          },
          {
            value: 52,
            itemStyle: {
              color: "transparent"
            }
          }
        ]
      },
      {
        name: '项目投资',
        type: 'pie',
        radius: [60, 80],
        center: ['50%', '50%'],
        labelLine: {
          show: false
        },
        data: [{
            value: 34,
            itemStyle: {
              color: "transparent"
            }
          },
          {
            value: 52,
            itemStyle: {
              color: new echarts.graphic.LinearGradient(0, 1, 0, 0, [{
                offset: 0,
                color: '#348fe6'
              }, {
                offset: 1,
                color: '#625bef'
              }])
            },
            label: {
              color: "rgba(255,255,255,.45)",
              fontSize: 14,
              rich: {
                a: {
                  color: "#fff",
                  fontSize: 20,
                  lineHeight: 30
                },
              }
            }
          }
        ]
      }
    ]
  };
  mychart_pie_four.setOption(option_pie_four);




  /* 总投资额 */
  let mychart_bar = echarts.init(document.getElementById("mychart_bar"));
  option_bar = {
    title: {
      text: '2018季度资金总投资额（万元）',
      textStyle: {
        color: "#ABCBFF",
        fontSize: 16,
      }
    },
    tooltip: {
      trigger: 'axis',
      axisPointer: {
        type: 'cross',
        crossStyle: {
          color: '#999'
        }
      },
      formatter: '{b} 比例 : {c2}',
      extraCssText: 'width:auto;height:auto;'
    },
    legend: {
      data: ['实际', '计划'],
      top: '6%',
      right: '10%',
      textStyle: {
        fontSize: 16,
        color: '#8597c1'
      }
    },
    xAxis: [{
      type: 'category',
      axisPointer: {
        type: 'shadow'
      },
      axisLine: {
        lineStyle: {
          color: '#8597c1'
        }
      },
      splitLine: {
        show: false
      },
      axisTick: {
        show: false
      },
      axisLabel: {
        show: true,
        interval: '0',
        textStyle: {
          fontSize: 16,
          color: '#8597c1'
        }
      },
    }],
    yAxis: [{
      type: 'value',
      min: 0,
      max: 100,
      interval: 20,
      axisLine: {
        lineStyle: {
          color: '#8597c1'
        }
      },
      splitLine: {
        show: false
      },
      axisTick: {
        show: false
      },
      axisLabel: {
        show: true,
        interval: '0',
        textStyle: {
          fontSize: 16,
          color: '#8597c1'
        }
      },
    }],
    series: [{
        name: '实际',
        type: 'bar',
        barWidth: 14,
        data: [20, 30, 40, 50, 35],
        itemStyle: {
          color: '#DD5A60'
        },
      },
      {
        name: '计划',
        type: 'bar',
        barWidth: 14,
        data: [22, 33, 44, 50, 26],
        itemStyle: {
          color: '#20ACE7'
        },
      }
    ]
  };
  mychart_bar.setOption(option_bar);


})


$(function () {
  // header('Access-Control-Allow-Origin:*'); 
  creatChinaMap('mychart_map');
  // $('.back_btn').click(function(){
  // 	creatChinaMap('main');
  // })
  var map_data = [{
      "name": "北京",
      "value": 2656
    },
    {
      "name": "天津",
      "value": 2342
    },
    {
      "name": "上海",
      "value": 3523
    },
    {
      "name": "重庆",
      "value": 423
    },
    {
      "name": "河北",
      "value": 2
    },
    {
      "name": "河南",
      "value": 323
    },
    {
      "name": "云南",
      "value": 54
    },
    {
      "name": "辽宁",
      "value": 42
    },
    {
      "name": "黑龙江",
      "value": 6464
    },
    {
      "name": "湖南",
      "value": 4242
    },
    {
      "name": "安徽",
      "value": 42
    },
    {
      "name": "山东",
      "value": 532
    },
    {
      "name": "新疆",
      "value": 455
    },
    {
      "name": "江苏",
      "value": 4635
    },
    {
      "name": "浙江",
      "value": 7534
    },
    {
      "name": "江西",
      "value": 243
    },
    {
      "name": "湖北",
      "value": 6345
    },
    {
      "name": "广西",
      "value": 432
    },
    {
      "name": "甘肃",
      "value": 45234
    },
    {
      "name": "山西",
      "value": 4234
    },
    {
      "name": "内蒙古",
      "value": 42
    },
    {
      "name": "陕西",
      "value": 4324
    },
    {
      "name": "吉林",
      "value": 432
    },
    {
      "name": "福建",
      "value": 4324
    },
    {
      "name": "贵州",
      "value": 43
    },
    {
      "name": "广东",
      "value": 4324
    },
    {
      "name": "青海",
      "value": 434
    },
    {
      "name": "西藏",
      "value": 7567
    },
    {
      "name": "四川",
      "value": 7657
    },
    {
      "name": "宁夏",
      "value": 75
    },
    {
      "name": "海南",
      "value": 3213
    },
    {
      "name": "台湾",
      "value": 5634
    },
    {
      "name": "香港",
      "value": 342
    },
    {
      "name": "澳门",
      "value": 97
    }
  ];
  var myChart_map = echarts.init(document.getElementById('mychart_map'));

  function creatChinaMap(id) {
    var myChart_map = echarts.init(document.getElementById('mychart_map'));
    $('.back_btn').hide();
    option_map = {
      // title: {
      // 	text: '全国各省',
      // 	left: 'center',
      // 	textStyle: {
      // 		color: '#D1DFFF'
      // 	}
      // 	,top:30
      // },
      tooltip: {
        trigger: ''
      },
      geo: {
        map: 'china',
        label: {
          emphasis: {
            show: false
          }
        },
        roam: true,
        itemStyle: {
          normal: {
            areaColor: '#323c48',
            borderColor: '#404a59'
          },
          emphasis: {
            areaColor: '#2a333d'
          }
        }
      },
      series: [{
        name: '产品分布',
        type: 'map',
        mapType: 'china',
        roam: false,
        label: {
          normal: {
            show: true
          },
          emphasis: {
            show: true
          }
        },
        data: map_data,
        itemStyle: {
          normal: {
            borderColor: '#000',
            areaColor: '#00FCF9'
          },
          emphasis: {
            areaColor: '#ccc',
            color: '#fff',
            borderWidth: 0,
            show: false,
          }
        },
      }]
    };
    myChart_map.setOption(option_map);
    myChart_map.on('click', function (parm) {
      console.log(parm, 'parm')
      console.log(id, 'id')
      creatProvince(parm.name, id);
      if (parm.name == '隆子县') {
        window.location.href = './longzi.html'
      }
    })
  }

  function creatProvince(name, id) {
    var pro = pyChinese(name);
    if (pro == '') {
      return false;
    }
    $('.back_btn').show();
    var childChart = echarts.init(document.getElementById(id));
    var seriesdata = [{
      type: 'map',
      mapType: pro,
      label: {
        normal: {
          show: true
        },
        emphasis: {
          show: true
        }
      },
      data: [],
      itemStyle: {
        normal: {
          borderColor: '#000',
          areaColor: '#00FCF9'
        },
        emphasis: {
          areaColor: '#ccc',
          color: '#fff',
          borderWidth: 0,
          show: false,
        }
      },
      animation: false
    }];
    var option = {
      // title: {
      // 	text: name,
      // 	left: 'center',
      //   top:30,
      // 	textStyle: {
      // 		color: '#D1DFFF'
      //   }
      // },
      series: seriesdata
    };
    $.get('json/' + pro + '.json', function (gdMap) {
      echarts.registerMap(pro, gdMap);
      childChart.setOption(option, true);
    });
  }

  function renderEachCity() {
    var option = {
      xAxis: [],
      yAxis: [],
      grid: [],
      series: []
    };
    // var inflationStartIdx = 14;
    // var inflationYearCount = 3;
    // var inflationYearStart = '2006';
    // var xAxisCategory = [];
    // for (var i = 0; i < inflationYearCount; i++) {
    //     xAxisCategory.push((+inflationYearStart + i) + '');
    // }

    echarts.util.each(map_data, function (dataItem, idx) {
      console.log(idx,'idx',dataItem)
      var geoCoord = map_data[idx];
      var coord = myChart_map.convertToPixel('geo', geoCoord);
      // var boundL = -12.782788213627585;
      // var boundR = 35.92763028872384;
      // var boundT = 32.22854555899493;
      // var boundB = 95.18817097360194;
      // if (!coord ||
      //     geoCoord[0] < boundL ||
      //     geoCoord[0] > boundR ||
      //     geoCoord[1] > boundB ||
      //     geoCoord[1] < boundT
      // ) {
      //     return;
      // }
      idx += '';

      inflationData = [30, 50, 20];
      // for (var k = 0; k < inflationYearCount; k++) {
      //     inflationData.push(dataItem[inflationStartIdx + k]);
      // }

      option.xAxis.push({
        id: idx,
        gridId: idx,
        type: 'category',
        name: dataItem[0],
        // nameStyle: {
        //     color: 'red',
        //     fontSize: 12
        // },
        nameLocation: 'middle',
        nameGap: 3,
        splitLine: {
          show: false
        },
        axisTick: {
          show: false
        },
        axisLabel: {
          show: false
        },
        axisLine: {
          onZero: false,
          lineStyle: {
            color: '#666'
          }
        },
        // data: xAxisCategory,
        data: ["数据A", "数据B", "数据C"],
        z: 100
      });
      option.yAxis.push({
        id: idx,
        gridId: idx,
        splitLine: {
          show: false
        },
        axisTick: {
          show: false
        },
        axisLabel: {
          show: false
        },
        axisLine: {
          show: false,
          lineStyle: {
            color: '#1C70B6'
          }
        },
        z: 100
      });
      option.grid.push({
        id: idx,
        width: 30,
        height: 40,
        // left: coord[0] - 15,
        // top: coord[1] - 15,
        z: 100
      });
      option.series.push({
        id: idx,
        type: 'bar',
        xAxisId: idx,
        yAxisId: idx,
        barGap: 0,
        barCategoryGap: 0,
        // data: inflationData,
        data: inflationData,
        z: 100,
        itemStyle: {
          normal: {
            color: function (params) {
              // 柱状图每根柱子颜色
              var colorList = ['#F75D5D', '#59ED4F', '#4C91E7'];
              return colorList[params.dataIndex];
            }
          }
        }
      });
    });
    console.time('a');
    myChart_map.setOption(option);
    console.timeEnd('a');
  }
  setTimeout(renderEachCity, 0)
})